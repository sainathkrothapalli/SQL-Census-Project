# Overview of data
Select *from project.census;

# Records count
select count(*) as "Number of records" from project.census;

#Telugu states data
select * from project.census where upper(state) in ('ANDHRA PRADESH');
# Telugu states no of districts
select count(*) as "Number of districts" from project.census where upper(state) in ('ANDHRA PRADESH');
# Telugu states lowest and highest literacy rates
select district,literacy as "Max literacy district" from project.census where upper(state) in ('ANDHRA PRADESH') and literacy in (
select max(literacy) from project.census where upper(state) in ('ANDHRA PRADESH'));
select district,literacy as "Min literacy district" from project.census where upper(state) in ('ANDHRA PRADESH') and literacy in (
select min(literacy) from project.census where upper(state) in ('ANDHRA PRADESH'));

# Indias total population based on 2011 census
SET SQL_SAFE_UPDATES = 0;
update  population set population=REPLACE(population, ',', '');
commit;
alter table population modify COLUMN population INT ;
Select sum(population) as "India's Population"  from population;

# States avg growth
update  census set growth=REPLACE(growth, '%', '');
commit;
alter table census modify COLUMN growth double ;
select state,round(avg(growth),2) as "States average growth"  from project.census
group by 1;

#State with lowest and highest Average growth
select state as "Highest growth state",round(avg(growth),2) as "States average growth"  from project.census
group by 1
order by 2 desc limit 1;
select state as "Lowest growth state",round(avg(growth),2) as "States average growth"  from project.census
group by 1
order by 2  limit 1;

# Average literacy rate by state
select state,round(avg(literacy),3) as "Average literacy"  from project.census
group by 1 ;
select state as " Highest literacy state",round(avg(literacy),3) as "Average literacy"  from project.census
group by 1 order by 2 desc limit 1;
select state as " Lowest literacy state",round(avg(literacy),3) as "Average literacy"  from project.census
group by 1 order by 2 limit 1;

# Top 5 highest Average literacy states
select z.* from (
select state as " Highest literacy state",round(avg(literacy),3) as "Average literacy" ,
dense_rank() over( order by round(avg(literacy),3) desc) rk
 from project.census
group by 1 ) z where z.rk<6;

# Top 5 highest Average literacy states
select z.* from (
select state as " Lowest literacy state",round(avg(literacy),3) as "Average literacy" ,
dense_rank() over( order by round(avg(literacy),3) ) rk
 from project.census
group by 1 ) z where z.rk<6;

# South indian states
select *from project.census where upper(state) in ('ANDHRA PRADESH','KERALA','TAMIL NADU','KARNATAKA');

# South india states Average literacy rate
select state as " SOUTH INDIAN state",round(avg(literacy),3) as "Average literacy"  from project.census
where upper(state) in ('ANDHRA PRADESH','KERALA','TAMIL NADU','KARNATAKA')
group by 1 order by 2 ;

# South india highest literacy state
select state as " Highest literacy sOUTH INDIAN state",round(avg(literacy),3) as "Average literacy"  from project.census
where upper(state) in ('ANDHRA PRADESH','KERALA','TAMI LNADU','KARNATAKA')
group by 1 order by 2 desc limit 1;

# South india lowest literacy state
select state as " Lowest literacy sOUTH INDIAN state",round(avg(literacy),3) as "Average literacy"  from project.census
where upper(state) in ('ANDHRA PRADESH','KERALA','TAMI LNADU','KARNATAKA')
group by 1 order by 2  limit 1;

